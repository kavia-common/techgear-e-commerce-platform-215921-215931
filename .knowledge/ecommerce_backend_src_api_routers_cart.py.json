{"is_source_file": true, "format": "Python", "description": "This file defines API endpoints for cart operations in an e-commerce backend, including retrieving the cart, adding items, updating items, removing items, and checkout process, using FastAPI and SQLAlchemy.", "external_files": ["src/core/security.py", "src/db/schemas/common.py", "src/db/schemas/commerce.py", "src/db/session.py", "src/db/crud/commerce.py"], "external_methods": ["get_current_user", "get_db", "get_cart_with_items", "add_to_cart", "update_cart_item", "remove_from_cart", "checkout_cart"], "published": ["router"], "classes": [], "methods": [{"name": "get_cart(current_user=Depends(get_current_user), db: Session = Depends(get_db))", "description": "Fetches and returns the current user's cart with items.", "scope": "", "scopeKind": ""}, {"name": "add_item( payload: CartItemCreate, current_user=Depends(get_current_user), db: Session = Depends(get_db), )", "description": "Adds a product to the user's cart with specified quantity, enforcing stock constraints.", "scope": "", "scopeKind": ""}, {"name": "update_item( product_id: int, quantity: int = Body(..., embed=True, description=\"New quantity\"), current_user=Depends(get_current_user), db: Session = Depends(get_db), )", "description": "Updates the quantity of a cart item or removes it if quantity <= 0.", "scope": "", "scopeKind": ""}, {"name": "remove_item( product_id: int, current_user=Depends(get_current_user), db: Session = Depends(get_db), )", "description": "Removes a product from the user's cart.", "scope": "", "scopeKind": ""}, {"name": "checkout( current_user=Depends(get_current_user), db: Session = Depends(get_db), )", "description": "Converts the current cart into an order, updating inventory and closing the cart.", "scope": "", "scopeKind": ""}], "calls": ["get_cart_with_items(db, current_user.id)", "add_to_cart(db, current_user.id, payload.product_id, payload.quantity)", "update_cart_item(db, current_user.id, product_id, quantity)", "remove_from_cart(db, current_user.id, product_id)", "checkout_cart(db, current_user.id)"], "search-terms": ["FastAPI cart API", "cart CRUD endpoints", "e-commerce cart management", "CartOut schema", "checkout cart"], "state": 2, "file_id": 21, "knowledge_revision": 70, "git_revision": "950dbad304f4efd341613bba69ff8d1db2ef1f6f", "revision_history": [{"49": "396ab42f7e4e666cb332d36aaf7cc654773a960d"}, {"65": "396ab42f7e4e666cb332d36aaf7cc654773a960d"}, {"70": "950dbad304f4efd341613bba69ff8d1db2ef1f6f"}], "ctags": [{"_type": "tag", "name": "add_item", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/cart.py", "pattern": "/^def add_item($/", "language": "Python", "kind": "function", "signature": "( payload: CartItemCreate, current_user=Depends(get_current_user), db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "checkout", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/cart.py", "pattern": "/^def checkout($/", "language": "Python", "kind": "function", "signature": "( current_user=Depends(get_current_user), db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "get_cart", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/cart.py", "pattern": "/^def get_cart(current_user=Depends(get_current_user), db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(current_user=Depends(get_current_user), db: Session = Depends(get_db))"}, {"_type": "tag", "name": "remove_item", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/cart.py", "pattern": "/^def remove_item($/", "language": "Python", "kind": "function", "signature": "( product_id: int, current_user=Depends(get_current_user), db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/cart.py", "pattern": "/^router = APIRouter(prefix=\"\\/cart\", tags=[\"Cart\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_item", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/cart.py", "pattern": "/^def update_item($/", "language": "Python", "kind": "function", "signature": "( product_id: int, quantity: int = Body(..., embed=True, description=\"New quantity\"), current_user=Depends(get_current_user), db: Session = Depends(get_db), )"}], "hash": "614e5f2e7d9b81e321e3d52f1202d4ad", "format-version": 4, "code-base-name": "ecommerce_backend", "filename": "ecommerce_backend/src/api/routers/cart.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/cart\", tags=[\"Cart\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}