{"is_source_file": true, "format": "Python", "description": "This file defines API routes for product operations in an e-commerce platform, including listing products with filters, sorting, and pagination, and creating new products (admin restricted). It uses FastAPI for routing and SQLAlchemy for database interactions.", "external_files": ["src/db/schemas/catalog.py", "src/db/schemas/common.py", "src/db/session.py", "src/core/security.py", "src/db/models/catalog.py", "src/db/crud/catalog.py"], "external_methods": ["get_db()", "admin_required()", "create_product()"], "published": ["get_products", "post_product"], "classes": [{"name": "PaginatedProducts", "description": "Response schema for paginated list of products, including items, total count, current page, and page size."}], "methods": [{"name": "get_products( db: Session = Depends(get_db), q: Optional[str] = Query(None, description=\"Search term for product name/description\"), category_id: Optional[int] = Query(None, description=\"Filter by category id\"), brand_id: Optional[int] = Query(None, description=\"Filter by brand id\"), min_price: Optional[int] = Query(None, description=\"Minimum price in cents\"), max_price: Optional[int] = Query(None, description=\"Maximum price in cents\"), in_stock: Optional[bool] = Query(None, description=\"Only products with stock > 0\"), sort: Optional[str] = Query(\"created_at:desc\", description=\"Sort field and direction, e.g., price_cents:asc\"), page: int = Query(1, ge=1, description=\"Page number\"), size: int = Query(10, ge=1, le=100, description=\"Page size\"), )", "description": "Handles GET requests to fetch a filtered, sorted, and paginated list of products. Supports search terms, category/brand filters, price range, stock availability, sorting options, and pagination.", "scope": "", "scopeKind": ""}, {"name": "post_product(payload: ProductCreate, db: Session = Depends(get_db))", "description": "Handles POST requests to create a new product. Restricted to admins via dependency injection.", "scope": "", "scopeKind": ""}], "calls": ["db.query(Product)", "query.filter()", "query.count()", "query.order_by()", "query.offset()", "query.limit()", "create_product()"], "search-terms": ["FastAPI product router", "Product listing with filters", "Pagination in FastAPI", "Create product API", "SQLAlchemy filter and sort"], "state": 2, "file_id": 18, "knowledge_revision": 62, "git_revision": "396ab42f7e4e666cb332d36aaf7cc654773a960d", "revision_history": [{"41": ""}, {"62": "396ab42f7e4e666cb332d36aaf7cc654773a960d"}], "ctags": [{"_type": "tag", "name": "PaginatedProducts", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/products.py", "pattern": "/^class PaginatedProducts(Message):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "get_products", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/products.py", "pattern": "/^def get_products($/", "language": "Python", "kind": "function", "signature": "( db: Session = Depends(get_db), q: Optional[str] = Query(None, description=\"Search term for product name/description\"), category_id: Optional[int] = Query(None, description=\"Filter by category id\"), brand_id: Optional[int] = Query(None, description=\"Filter by brand id\"), min_price: Optional[int] = Query(None, description=\"Minimum price in cents\"), max_price: Optional[int] = Query(None, description=\"Maximum price in cents\"), in_stock: Optional[bool] = Query(None, description=\"Only products with stock > 0\"), sort: Optional[str] = Query(\"created_at:desc\", description=\"Sort field and direction, e.g., price_cents:asc\"), page: int = Query(1, ge=1, description=\"Page number\"), size: int = Query(10, ge=1, le=100, description=\"Page size\"), )"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/products.py", "pattern": "/^    items: List[ProductOut] = []$/", "language": "Python", "typeref": "typename:List[ProductOut]", "kind": "variable", "scope": "PaginatedProducts", "scopeKind": "class"}, {"_type": "tag", "name": "page", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/products.py", "pattern": "/^    page: int = 1$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "PaginatedProducts", "scopeKind": "class"}, {"_type": "tag", "name": "post_product", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/products.py", "pattern": "/^def post_product(payload: ProductCreate, db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(payload: ProductCreate, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/products.py", "pattern": "/^router = APIRouter(prefix=\"\\/products\", tags=[\"Products\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "size", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/products.py", "pattern": "/^    size: int = 10$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "PaginatedProducts", "scopeKind": "class"}, {"_type": "tag", "name": "total", "path": "/home/kavia/workspace/code-generation/techgear-e-commerce-platform-215921-215931/ecommerce_backend/src/api/routers/products.py", "pattern": "/^    total: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "PaginatedProducts", "scopeKind": "class"}], "hash": "d954145050a4442df762fb56f1647bbc", "format-version": 4, "code-base-name": "ecommerce_backend", "filename": "ecommerce_backend/src/api/routers/products.py", "fields": [{"name": "List[ProductOut] items", "scope": "PaginatedProducts", "scopeKind": "class", "description": "unavailable"}, {"name": "int page", "scope": "PaginatedProducts", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/products\", tags=[\"Products\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int size", "scope": "PaginatedProducts", "scopeKind": "class", "description": "unavailable"}, {"name": "int total", "scope": "PaginatedProducts", "scopeKind": "class", "description": "unavailable"}]}